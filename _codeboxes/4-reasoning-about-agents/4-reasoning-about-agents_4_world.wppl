var world = restaurantChoiceMDP;
var feature = world.feature;

var utilityTablePrior = function(){
  var baseUtilityTable = {
    'Donut S': 1,
    'Donut N': 1,
    Veg: 1,
    Noodle: 1,
    timeCost: -0.05
  };
  return uniformDraw( 
    [{table: update(baseUtilityTable, {'Donut N':2, 'Donut S':2}),
      favourite: 'donut'},
     {table: update(baseUtilityTable, {Veg:2}),
      favourite: 'veg'},
     {table: update(baseUtilityTable, {Noodle:2}),
      favourite: 'noodle'}]
  );
};
var alpha = 100;
var observedStateAction = [[{loc: [3,1],
			                 timeLeft: 10,
							 terminateAfterAction: false}, 'l']];

var posterior = Enumerate( function(){
  var utilityTableAndFavourite = utilityTablePrior();
  var utilityTable = utilityTableAndFavourite.table;
  var utility = mdpTableToUtilityFunction(utilityTable, feature);
  var favourite = utilityTableAndFavourite.favourite;

  var params = {utility: utility,
		        alpha: alpha};
  var agent  = makeMDPAgent(params, world);
  var act = agent.act;
  // For each observed state-action pair, compute likekihood of action
  map( function(stateAction){
    factor( act(stateAction[0]).score( [], stateAction[1]) );
  }, observedStateAction );

  return {favourite: favourite};
});

viz.vegaPrint(posterior);
